# PgCat Configuration for SMSLY Platform
# High-performance PostgreSQL connection pooler with SCRAM-SHA-256 support

[general]
host = "0.0.0.0"
port = 5432
admin_username = "admin"
admin_password = "admin_password_change_me"
connect_timeout = 5000
idle_timeout = 30000
log_client_connections = true
log_client_disconnections = true
worker_threads = 4
autoreload = 15000

# Single pool for all databases - PgCat routes by database name
[pools.smsly_backend]
pool_mode = "transaction"
load_balancing_mode = "random"
default_role = "primary"
query_parser_enabled = false
sharding_function = "pg_bigint_hash"
pool_size = 50
min_pool_size = 5

[pools.smsly_backend.users.0]
username = "postgres"
password = "Sm5Ly2026ProdDB9xKmNv"
pool_size = 50

[pools.smsly_backend.shards.0]
servers = [["os4wks048wg8ckkcgo44gsw0", 5432, "primary"]]
database = "smsly_backend"

# Audit database
[pools.smsly_audit]
pool_mode = "transaction"
load_balancing_mode = "random"
default_role = "primary"
query_parser_enabled = false
sharding_function = "pg_bigint_hash"
pool_size = 20
min_pool_size = 2

[pools.smsly_audit.users.0]
username = "postgres"
password = "Sm5Ly2026ProdDB9xKmNv"
pool_size = 20

[pools.smsly_audit.shards.0]
servers = [["os4wks048wg8ckkcgo44gsw0", 5432, "primary"]]
database = "smsly_audit"

# Txchain database
[pools.smsly_txchain]
pool_mode = "transaction"
load_balancing_mode = "random"
default_role = "primary"
query_parser_enabled = false
sharding_function = "pg_bigint_hash"
pool_size = 30
min_pool_size = 3

[pools.smsly_txchain.users.0]
username = "postgres"
password = "Sm5Ly2026ProdDB9xKmNv"
pool_size = 30

[pools.smsly_txchain.shards.0]
servers = [["os4wks048wg8ckkcgo44gsw0", 5432, "primary"]]
database = "smsly_txchain"

# Identity database
[pools.smsly_identity]
pool_mode = "transaction"
load_balancing_mode = "random"
default_role = "primary"
query_parser_enabled = false
sharding_function = "pg_bigint_hash"
pool_size = 30
min_pool_size = 3

[pools.smsly_identity.users.0]
username = "postgres"
password = "Sm5Ly2026ProdDB9xKmNv"
pool_size = 30

[pools.smsly_identity.shards.0]
servers = [["os4wks048wg8ckkcgo44gsw0", 5432, "primary"]]
database = "smsly_identity"

# Platform database
[pools.smsly_platform]
pool_mode = "transaction"
load_balancing_mode = "random"
default_role = "primary"
query_parser_enabled = false
sharding_function = "pg_bigint_hash"
pool_size = 40
min_pool_size = 5

[pools.smsly_platform.users.0]
username = "postgres"
password = "Sm5Ly2026ProdDB9xKmNv"
pool_size = 40

[pools.smsly_platform.shards.0]
servers = [["os4wks048wg8ckkcgo44gsw0", 5432, "primary"]]
database = "smsly_platform"

# Policy database
[pools.smsly_policy]
pool_mode = "transaction"
load_balancing_mode = "random"
default_role = "primary"
query_parser_enabled = false
sharding_function = "pg_bigint_hash"
pool_size = 20
min_pool_size = 2

[pools.smsly_policy.users.0]
username = "postgres"
password = "Sm5Ly2026ProdDB9xKmNv"
pool_size = 20

[pools.smsly_policy.shards.0]
servers = [["os4wks048wg8ckkcgo44gsw0", 5432, "primary"]]
database = "smsly_policy"

# Gateway database
[pools.smsly_gateway]
pool_mode = "transaction"
load_balancing_mode = "random"
default_role = "primary"
query_parser_enabled = false
sharding_function = "pg_bigint_hash"
pool_size = 30
min_pool_size = 3

[pools.smsly_gateway.users.0]
username = "postgres"
password = "Sm5Ly2026ProdDB9xKmNv"
pool_size = 30

[pools.smsly_gateway.shards.0]
servers = [["os4wks048wg8ckkcgo44gsw0", 5432, "primary"]]
database = "smsly_gateway"
